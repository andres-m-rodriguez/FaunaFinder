@inherits LayoutComponentBase

<MudThemeProvider Theme="_theme" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Color="Color.Primary" Fixed="true" Dense="true">
        <MudText Typo="Typo.h6" Class="ml-2">FaunaFinder</MudText>
        <MudSpacer />
        <MudButton Href="/" Color="Color.Inherit" Variant="Variant.Text">Map</MudButton>
        <MudButton Href="/species" Color="Color.Inherit" Variant="Variant.Text">Species</MudButton>
        <MudButton Href="/pueblos" Color="Color.Inherit" Variant="Variant.Text">Pueblos</MudButton>
        <MudButton Href="/about" Color="Color.Inherit" Variant="Variant.Text">About</MudButton>
    </MudAppBar>

    <MudMainContent Class="pt-14">
        <ErrorBoundary @ref="errorBoundary">
            <ChildContent>
                @Body
            </ChildContent>
            <ErrorContent Context="ex">
                <MudContainer MaxWidth="MaxWidth.Small" Class="d-flex flex-column align-center justify-center" Style="height: calc(100vh - 64px);">
                    <MudPaper Elevation="3" Class="pa-6 text-center">
                        <MudIcon Icon="@Icons.Material.Filled.Error" Color="Color.Error" Size="Size.Large" Class="mb-4" />
                        <MudText Typo="Typo.h5" Class="mb-2">Something went wrong</MudText>
                        <MudText Typo="Typo.body2" Color="Color.Secondary" Class="mb-4">
                            An unexpected error occurred. Please try again.
                        </MudText>
                        <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="RecoverFromError">
                            Try Again
                        </MudButton>
                    </MudPaper>
                </MudContainer>
            </ErrorContent>
        </ErrorBoundary>
    </MudMainContent>
</MudLayout>

@code {
    private ErrorBoundary? errorBoundary;

    private readonly MudTheme _theme = new()
    {
        PaletteLight = new PaletteLight
        {
            Primary = "#2d6a4f",
            PrimaryDarken = "#1b4332",
            PrimaryLighten = "#40916c",
            Secondary = "#40916c",
            AppbarBackground = "#2d6a4f",
            Background = "#f8f9fa",
            Surface = "#ffffff",
            DrawerBackground = "#ffffff"
        }
    };

    private void RecoverFromError()
    {
        errorBoundary?.Recover();
    }
}
